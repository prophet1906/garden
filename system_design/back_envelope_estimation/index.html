<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Creating design for a system isn&rsquo;t helpful unless you can justify why your design is better than others. After creating a design, there will be questions on weather the design fulfills the specified requirements."><title>Back of the Envelope Estimation</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://prophet1906.github.io/garden//icon.png><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Source+Sans+Pro:wght@400;600;700&family=Fira+Code:wght@400;700&display=swap" rel=stylesheet><link href=https://prophet1906.github.io/garden/styles.efd5aa8bc060db79336b0e65f4ed3c7f.min.css rel=stylesheet><script src=https://prophet1906.github.io/garden/js/darkmode.46b07878b7f5d9e26ad7a3c40f8a0605.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script src=https://prophet1906.github.io/garden/js/popover.688c5dcb89a57776d7f1cbeaf6f7c44b.min.js></script>
<script>const BASE_URL="https://prophet1906.github.io/garden/",fetchData=Promise.all([fetch("https://prophet1906.github.io/garden/indices/linkIndex.414e374e9dd49e9dc6188152362ead19.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://prophet1906.github.io/garden/indices/contentIndex.b5e84a3fcfc4b9fb05ad03e209835978.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),draw=()=>{const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(draw);e.textContent="",drawGraph("https://prophet1906.github.io/garden",[{"/books":"#ca1919"}],-1,!0,!0,!0),initPopover("https://prophet1906.github.io/garden",null,!0),renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})}</script><script>window.navigate=e=>window.location.href=e,draw()</script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-HXZ0Y3QQ8Q"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-HXZ0Y3QQ8Q",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://prophet1906.github.io/garden/js/search.06935f6a9c1dd79aa33fe3a725067dbc.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://prophet1906.github.io/garden/>ðŸª´ Shubham's Digital Garden</a></h1><svg tabindex="0" id="search-icon" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg><div class=spacer></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Back of the Envelope Estimation</h1><p class=meta>Last updated May 26, 2022</p><ul class=tags><li><a href=https://prophet1906.github.io/garden/tags/system-design/>System design</a></li></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#power-of-two>Power of two</a></li><li><a href=#latency-numbers>Latency numbers</a></li><li><a href=#availability-numbers>Availability numbers</a></li><li><a href=#example-estimate-twitter-qps-and-storage-requirements>Example: Estimate Twitter QPS and storage requirements</a><ol><li><a href=#assumptions>Assumptions</a></li><li><a href=#estimations>Estimations</a></li></ol></li><li><a href=#tips>Tips</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#references>References</a></li></ol></nav></details></aside><p>Creating design for a system isn&rsquo;t helpful unless you can justify why your design is better than others. After creating a design, there will be questions on weather the design fulfills the specified requirements.</p><p>According to <strong>Jeff Dean</strong>, Google Senior Fellow, &ldquo;back-of-the-envelope calculations are estimates you create using a combination of thought experiments and common performance numbers to get a good feel for which design will meet your requirements&rdquo;.</p><p>A good sense of scalability basics are required to do back-of-the-envelope estimation.</p><a href=#power-of-two><h2 id=power-of-two><span class=hanchor arialabel=Anchor># </span>Power of two</h2></a><p>An ASCII character uses one byte of memory (8 bits). Given below is data volume unit using power of 2.</p><table><thead><tr><th style=text-align:center>Power</th><th style=text-align:center>Approximate Value</th><th style=text-align:center>Full name</th><th style=text-align:center>Short name</th></tr></thead><tbody><tr><td style=text-align:center>10</td><td style=text-align:center>1 Thousand</td><td style=text-align:center>1 Kilobyte</td><td style=text-align:center>1 KB</td></tr><tr><td style=text-align:center>20</td><td style=text-align:center>1 Million</td><td style=text-align:center>1 Megabyte</td><td style=text-align:center>1 MB</td></tr><tr><td style=text-align:center>30</td><td style=text-align:center>1 Billion</td><td style=text-align:center>1 Gigabyte</td><td style=text-align:center>1 GB</td></tr><tr><td style=text-align:center>40</td><td style=text-align:center>1 Trillion</td><td style=text-align:center>1 Terabyte</td><td style=text-align:center>1 TB</td></tr><tr><td style=text-align:center>50</td><td style=text-align:center>1 Quadrillion</td><td style=text-align:center>1 Petabyte</td><td style=text-align:center>1 PB</td></tr></tbody></table><a href=#latency-numbers><h2 id=latency-numbers><span class=hanchor arialabel=Anchor># </span>Latency numbers</h2></a><p>Latency numbers as revealed by Dr. Dean from Google in 2010 may be outdated because of faster and more powerful computers. But, these numbers should still help you to get general idea of fastness and slowness of different computer operations.</p><table><thead><tr><th style=text-align:center>Operation name</th><th style=text-align:center>Time</th></tr></thead><tbody><tr><td style=text-align:center>L1 cache reference</td><td style=text-align:center>0.5 ns</td></tr><tr><td style=text-align:center>Branch mispredict</td><td style=text-align:center>5 ns</td></tr><tr><td style=text-align:center>L2 cache reference</td><td style=text-align:center>7 ns</td></tr><tr><td style=text-align:center>Mutex lock/unlock</td><td style=text-align:center>100 ns</td></tr><tr><td style=text-align:center>Main memory reference</td><td style=text-align:center>100 ns</td></tr><tr><td style=text-align:center>Compress 1K bytes with Zippy</td><td style=text-align:center>10,000 ns = 10 $\micro$s</td></tr><tr><td style=text-align:center>Send 2K bytes over 1 Gbps network</td><td style=text-align:center>20,000 ns = 20 $\micro$s</td></tr><tr><td style=text-align:center>Read 1 MB sequentially from memory</td><td style=text-align:center>250,000 ns = 250 $\micro$s</td></tr><tr><td style=text-align:center>Round trip within the same datacenter</td><td style=text-align:center>500,000 ns = 500 $\micro$s</td></tr><tr><td style=text-align:center>Disk seek</td><td style=text-align:center>10,000,000 ns = 10 ms</td></tr><tr><td style=text-align:center>Read 1 MB sequentially from the network</td><td style=text-align:center>10,000,000 ns = 10 ms</td></tr><tr><td style=text-align:center>Read 1 MB sequentially from disk</td><td style=text-align:center>30,000,000 ns = 30 ms</td></tr><tr><td style=text-align:center>Send packet CA(California)->Netherlands->CA</td><td style=text-align:center>150,000,000 ns = 150 ms</td></tr></tbody></table><p><strong>ns = nanosecond
$\micro$s = microsecond
ms = millisecond</strong></p><p><strong>1 ns = 10-9 seconds
1 $\micro$s = 10-6 seconds = 1,000 ns
1 ms = 10-3 seconds = 1,000 $\micro$s = 1,000,000 ns</strong></p><p>Some conclusions from above numbers-</p><ul><li>Memory is fast but disk is slow</li><li>Avoid disk seeks if possible</li><li>Simple compression algorithms are fast</li><li>Compress data before sending it over the internet if possible</li><li>Data centers are usually in different regions, and it takes time to send data between them</li></ul><a href=#availability-numbers><h2 id=availability-numbers><span class=hanchor arialabel=Anchor># </span>Availability numbers</h2></a><p>A <strong>service level agreement(SLA)</strong> is commonly used as an agreement between the service provider and their customer. This agreement formally defines the level of uptime your service will deliver. The uptime is measured as percentage and it falls between <strong>99%</strong> and <strong>100%</strong> for most services. Uptime is typically measured in nines, more nines is better. Number of nines correlate to the expected system downtime.</p><table><thead><tr><th style=text-align:center>Availability %</th><th style=text-align:center>Downtime per day</th><th style=text-align:center>Downtime per year</th></tr></thead><tbody><tr><td style=text-align:center>99%</td><td style=text-align:center>14.40 minutes</td><td style=text-align:center>3.65 days</td></tr><tr><td style=text-align:center>99.9%</td><td style=text-align:center>1.44 minutes</td><td style=text-align:center>8.77 hours</td></tr><tr><td style=text-align:center>99.99%</td><td style=text-align:center>8.64 seconds</td><td style=text-align:center>52.60 minutes</td></tr><tr><td style=text-align:center>99.999%</td><td style=text-align:center>864.00 milliseconds</td><td style=text-align:center>5.26 minutes</td></tr><tr><td style=text-align:center>99.9999%</td><td style=text-align:center>86.40 milliseconds</td><td style=text-align:center>31.56 seconds</td></tr></tbody></table><p>Anything above 5 nines is considered highly available.</p><a href=#example-estimate-twitter-qps-and-storage-requirements><h2 id=example-estimate-twitter-qps-and-storage-requirements><span class=hanchor arialabel=Anchor># </span>Example: Estimate Twitter QPS and storage requirements</h2></a><p>Following numbers are just to showcase how back-of-the-envelope-estimation works, these are not real numbers from twitter.</p><a href=#assumptions><h3 id=assumptions><span class=hanchor arialabel=Anchor># </span>Assumptions</h3></a><ul><li>300 million monthly active users</li><li>50% of users use twitter daily</li><li>Users post 2 tweets per day on average</li><li>10% of tweets contain media</li><li>Data is stored for 5 years</li></ul><a href=#estimations><h3 id=estimations><span class=hanchor arialabel=Anchor># </span>Estimations</h3></a><p><strong>Query per second(QPS)</strong> estimate:</p><ul><li>Daily active users(DAU) = 300 million * 50% = 150 million</li><li>Tweets QPS = 150 million * 2 tweets / 24 hour / 3600 seconds = ~3500</li><li>Peek QPS = 2 * QPS = ~7000</li></ul><p>We will only estimate media storage here.</p><ul><li>Average tweet size:<ul><li>tweet_id -> 64 bytes</li><li>text -> 140 bytes</li><li>media -> 1 MB</li></ul></li><li>Media storage: 150 million * 2 * 10% * 1 MB = 30 TB per day</li><li>5-year media storage: 3 TB * 365 * 5 = ~55 PB</li></ul><a href=#tips><h2 id=tips><span class=hanchor arialabel=Anchor># </span>Tips</h2></a><p>Back-of-the-envelope estiimations don&rsquo;t need to be extremely accurate, they are just meant to give approximate idea of scale. Few tips are as follows-</p><ul><li>Rounding and Approximation wherever necessary for speed calculation, precision isn&rsquo;t expected at design stage</li><li>Write down assumptions to be referenced later</li><li>Label units to remove ambiguity from numbers and not confuse yourself</li></ul><a href=#conclusion><h2 id=conclusion><span class=hanchor arialabel=Anchor># </span>Conclusion</h2></a><p>This note gives basic idea of how back-of-the-envelope calculations work. You should practice these calculations on all designs you visit. More practice will help you get rough numbers in mind and select or discard ideas when brainstorming new system design.</p><a href=#references><h2 id=references><span class=hanchor arialabel=Anchor># </span>References</h2></a><ul><li><a href=/garden/books/sys_design_alex_xu rel=noopener class=internal-link data-src=/garden/books/sys_design_alex_xu>books/sys_design_alex_xu</a></li></ul></article><hr><div class=page-end><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/garden// data-ctx="Back of the Envelope Estimation" data-src=/ class=internal-link>Shubham's Digital GardenðŸª´</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://prophet1906.github.io/garden/js/graph.0eb0c81d58a703569f31b6053242af38.js></script></div></div><div id=contact_buttons><footer><p>Made by Shubham using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2022</p><ul><li><a href=/>Home</a></li><li><a href=https://twitter.com/Shubham_null>Twitter</a></li><li><a href=https://github.com/prophet1906>Github</a></li></ul></footer></div></div></body></html>