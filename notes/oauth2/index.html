<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="The OAuth 2.0 Authorization framework enables a third-party application to obtain limited access to an HTTP service, either on behalf of a resource owner by orchestrating an approval interaction between the resource owner and the HTTP service, or by allowing the third-party application to obtain access on its own behalf."><title>The OAuth 2.0 Authorization Framework : Conceptual Overview</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://prophet1906.github.io/garden//icon.png><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Source+Sans+Pro:wght@400;600;700&family=Fira+Code:wght@400;700&display=swap" rel=stylesheet><link href=https://prophet1906.github.io/garden/styles.cd61336c89ed6e03702366ce4a492b75.min.css rel=stylesheet><script src=https://prophet1906.github.io/garden/js/darkmode.46b07878b7f5d9e26ad7a3c40f8a0605.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})})</script><script>const BASE_URL="https://prophet1906.github.io/garden/",fetchData=Promise.all([fetch("https://prophet1906.github.io/garden/indices/linkIndex.8898a7569ded6bfca37871a0d727c94f.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://prophet1906.github.io/garden/indices/contentIndex.09066719dac877accfd94fa89f806851.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n}))</script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-HXZ0Y3QQ8Q"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-HXZ0Y3QQ8Q",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://prophet1906.github.io/garden/js/search.bc849b857f2c1b822264d40635bb67b6.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://prophet1906.github.io/garden/>ðŸª´ Shubham's Digital Garden</a></h1><svg tabindex="0" id="search-icon" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg><div class=spacer></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>The OAuth 2.0 Authorization Framework : Conceptual Overview</h1><p class=meta>Last updated May 23, 2022</p><ul class=tags><li><a href=https://prophet1906.github.io/garden/tags/oauth2/>Oauth2</a></li><li><a href=https://prophet1906.github.io/garden/tags/framework/>Framework</a></li><li><a href=https://prophet1906.github.io/garden/tags/security/>Security</a></li><li><a href=https://prophet1906.github.io/garden/tags/rfc/>RFC</a></li></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#introduction>Introduction</a><ol><li><a href=#roles>Roles</a></li><li><a href=#protocol-flow>Protocol Flow</a></li><li><a href=#authorization-grant>Authorization Grant</a></li><li><a href=#access-token>Access Token</a></li><li><a href=#refresh-token>Refresh Token</a></li></ol></li><li><a href=#client-registration>Client Registration</a><ol><li><a href=#client-types>Client Types</a></li><li><a href=#client-identifier>Client Identifier</a></li><li><a href=#client-authentication>Client Authentication</a></li></ol></li><li><a href=#protocol-endpoints>Protocol Endpoints</a></li><li><a href=#obtaining-authorization>Obtaining Authorization</a><ol><li><a href=#authorization-code-grant>Authorization Code Grant</a></li><li><a href=#implicit-grant>Implicit Grant</a></li><li><a href=#resource-owner-password-credentials-grant>Resource Owner Password Credentials Grant</a></li><li><a href=#client-credentials-grant>Client Credentials Grant</a></li></ol></li><li><a href=#conclusion>Conclusion</a></li></ol></nav></details></aside><p>The OAuth 2.0 Authorization framework enables a third-party application to obtain limited access to an HTTP service, either on behalf of a resource owner by orchestrating an approval interaction between the resource owner and the HTTP service, or by allowing the third-party application to obtain access on its own behalf.</p><p><strong>Real world example</strong> - Login/Signup with google button in third party websites like twitter, linkedin, etc use oauth 2.0 for authorization from your existing google account.</p><h2 id=introduction>Introduction</h2><p>Following figure shows traditional client-server authentication model.</p><p><img src=/garden/Excalidraw/oauth/traditional-client-server-auth.excalidraw.png title=/garden/Excalidraw/oauth/traditional-client-server-auth.excalidraw.png></p><p>Problems & Limitations with this approach:</p><ul><li>Third-party applications store resource owner&rsquo;s credentials</li><li>Resource servers are required to support password authentication</li><li>Third-party applications gain overly broad access to resources because credentials are shared</li><li>Resource owner&rsquo;s lack ability to restrict duration or access to subset of resources</li><li>Resource owner&rsquo;s cannot revoke access to individual third party without changing credentials</li><li>Compromise of third-party application results in compromise of the end-user&rsquo;s password and all data protected by that password</li></ul><p>OAuth addresses these issues by introducing an authorization layer and separating the role of the client and resource owner. In OAuth, every client is issued different set of credentials than those of the resource owner. Instead of using the resource owner&rsquo;s credentials to access protected resources, the client obtains an access token &ndash; a string denoting a specific scope, lifetime, and other access attributes. Access tokens are issued to third-party clients by an authorization server with the approval of the resource owner. The client uses the access token to access the protected resources hosted by the resource server.</p><h3 id=roles>Roles</h3><p>OAuth defines four roles:</p><ol><li><strong>Resource owner</strong> - An entity capable of granting access to a protected resource. When the resource owner is a person, it is referred to as an end-user. Example - Google account owner/end user</li><li><strong>Resource server</strong> - The server hosting the protected resources, capable of accepting and responding to protected resource requests using access tokens. Example -
<a href=https://developers.google.com/people/ rel=noopener>People API</a></li><li><strong>Client</strong> - An application making protected resource requests on behalf of the resource owner and with its authorization. The term &ldquo;client&rdquo; does not imply any particular implementation characteristics (e.g., wheather the application executes on a server, a desktop, or other devices). Example - Twitter web/android app</li><li><strong>Authorization Server</strong> - The server issuing access tokens to the client after successfully authenticating the resource owner and obtaining authorization. Example -
<a href=https://developers.google.com/identity rel=noopener>Google Identity Service</a></li></ol><p>Real world example showing all roles - When you press login with google button in twitter(<strong>Client</strong>) login page, it redirects you to google(<strong>Authorization Server</strong>) login page. After logging into google, it requests your(<strong>Resource Owner</strong>) permission to allow access to your contacts from People API(<strong>Resource Server</strong>). Twitter uses this contact info to suggest people to follow.</p><h3 id=protocol-flow>Protocol Flow</h3><p><img src=/garden/Excalidraw/oauth/abstract-protocol-flow.excalidraw.png title=/garden/Excalidraw/oauth/abstract-protocol-flow.excalidraw.png></p><p>The figure above illustrates abstract OAuth 2.0 flow with interaction between the 4 roles and includes following steps:</p><h3 id=authorization-grant>Authorization Grant</h3><p>Authorization grant is a credential representing resource owner&rsquo;s authorization used by the client to obtain an access token.</p><p>There are 4 types of authorization grant:</p><ol><li>Authorization Code Grant</li><li>Implicit Grant</li><li>Resource Owner Password Credentials Grant</li><li>Client Credentials Grant</li></ol><p><a href=https://www.rfc-editor.org/rfc/rfc6749.html rel=noopener>RFC 6749: The OAuth 2.0 Authorization Framework)</a> also provides extensibility mechanism for defining additional types.</p><h3 id=access-token>Access Token</h3><p>Access tokens are credentials used to access protected resources. An access token is a string representing an authorization issues to the client. The string is usually opaque to the client. Tokens represent specific scopes and durations of access, granted by resource owner, and enforced by resource server and authorization server.</p><h3 id=refresh-token>Refresh Token</h3><p>Refresh tokens are credentials used to obtain access tokens. Refresh tokens are issued to the client by the auhorization server and are used to obtain a new access token when current access token becomes invalid ot expires, or to obtain additional access token with narrower scope (access tokens may have shorter lifetime and fewer permissions than authorized by resource owner).</p><p>Following figure illustrates how refresh tokens are used to get new access token.</p><p><img src=/garden/Excalidraw/oauth/refresh-expired-access-token.excalidraw.png title=/garden/Excalidraw/oauth/refresh-expired-access-token.excalidraw.png></p><h2 id=client-registration>Client Registration</h2><p>Before initiating the protocol, client registers itself with authorization server. This process is beyond the scope of this note but typically involves end-user interaction with an HTML registration form.</p><p>Example - Google Login Page after getting redirected by a website</p><p>When registering a client, the client developer shall:</p><ul><li>specify the client type</li><li>provide its client redirection URIs</li><li>include any other information required by the authorization server (e.g., application name, website, description, logo image, the acceptance of legal terms)</li></ul><h3 id=client-types>Client Types</h3><p>OAuth defines 2 client types, based on their ability to authenticate securely with the authorization server (i.e., ability to maintain the confidentiality of their client credentials):</p><ul><li><strong>confidential</strong> : Clients capable of maintaining the confidentiality of their credentials (e.g., client implemented on a secure server with restricted access to client credentials), or capable of secure client authentication using other means.</li><li><strong>public</strong> : Client incapable of maintaining the confidentiality if their credentials (e.g., clients executing on the device used by the resource owner, such as an installed native application or a web browser-based application), and incapable of secure client authentication via any other means.</li></ul><p>Client type specification mentioned above was designed around the following client profiles:</p><ul><li><strong>Web application</strong> : A web application is a confidential client running on a web server. Resource owners access the client via an HTML user interface rendered in a user-agent on the device used by the resource owner. The client credentials as well as any access token issued to client are stored on the web server and are not exposed to or accessible by resource owner.</li><li><strong>User-agent-based application</strong> : A user-agent-based application is a public client in which the client code is downloaded from a web server and executes within a user-agent(e.g., web browser) on the device used by the resource owner. Protocol data and credentials are easily accessible (and often visible) to resource owner. Since such applications reside within the user-agent, they can make seamless use of the user-agent capabilities when requesting authorization.</li><li><strong>Native application</strong> : A native application is a public client installed and executed on the device used by the resource owner. Protocol data and credentials are accessible to the resource owner. It is assumed that any client authentication credentials included in the application can be extracted. On the other hand, dynamically issued credentials such as access tokens or refresh tokens can receive acceptable level of protection. At a minimum, these credentials are protected from hostile servers with which the application may interact. On some platforms, these credentials might be protected from other applications residing on the same device.</li></ul><h3 id=client-identifier>Client Identifier</h3><p>Authorization server issues a unique client identifier to every registered client. Client identifier is not a secret and is exposed to resource owner.</p><h3 id=client-authentication>Client Authentication</h3><p>For confidential client type, client and authorization server establish client authentication method suitable for the security requirement of the authorization server.</p><p>Confidential clients are typically issues a set of client credentials used for authenticating with the authorization server (e.g., password, public/private key pair). <strong>Example</strong> - Applications in Cloud Foundry may use client credentials present in <strong>VCAP_SERVICES</strong> for any oauth secured service.</p><h2 id=protocol-endpoints>Protocol Endpoints</h2><p>The authorization process utilizes 2 authorization server endpoints (HTTP resources):</p><ul><li><strong>Authorization Endpoint</strong> - used by the client to obtain authorization from the resource owner via user-agent redirection.</li><li><strong>Token Endpoint</strong> - used by the client to exchange an authorization grant for an access token, typically with client authentication.</li></ul><p>As well as one client endpoint:</p><ul><li><strong>Redirection endpoint</strong> - used by the authorization server to return responses containing authorization credentials to the client via the resource owner user-agent.</li></ul><h2 id=obtaining-authorization>Obtaining Authorization</h2><p>To request an access token, the client obtains authorization from the resource owner. The authorization is expressed in the form of an authorization grant, which client uses to request access token.</p><h3 id=authorization-code-grant>Authorization Code Grant</h3><p>The authorization code grant type is used to obtain both access tokens and refresh tokens and is optimized for confidential clients.
Since this is a redirection-based flow, the client must be capable of interacting with the resource owner&rsquo;s user-agent (typically a web browser) and capable of receiving incoming requests (via redirection) from the authorization server.</p><p>The Authorization Code grant can be used anytime you connect a userÂ profile to one or multiple accounts from within a websiteÂ and for instance you authorizeÂ the website to access information owned from LinkedIn, Facebook, Twitter, etcâ€¦.even all at the same time.</p><p>Example - Connecting linkedin account to twitter account and allowing linkedin to access your twitter timeline information.</p><p><img src=/garden/Excalidraw/oauth/authorization-code-flow.excalidraw.png title=/garden/Excalidraw/oauth/authorization-code-flow.excalidraw.png>
The lines illustrating steps A, B, C are broken into two parts as they pass through the user-agent.</p><h3 id=implicit-grant>Implicit Grant</h3><p>The implicit grant type is used to obtain access tokens(without any support for refresh token) and is optimized for public clients known to operate a particular redirection URI. These clients are typically implemented in a browser using a scripting language such as Javascript.</p><p>Since this is a redirection-based flow, the client must be capable of interacting with the resource owner&rsquo;s user-agent (typically a web browser) and capable of receiving incoming requests (via redirection) from the authorization server.</p><p>Unlike the authorization code grant type, in which the client makes separate requests for authorization and for an access token, the client receives the access token as the result of the authorization request.</p><p>The implicit grant type does not include client authentication, and relies on the presence of the resource owner and the registration of the redirection URI.</p><p>The Implicit Grant is very similar to the Authorization grant , but is not as secure as the first one. Another application running on the same machine / device could steal the authorization information exchanged between the client and the third party library and use it.</p><p>A malicious client can impersonate another client and obtain access to protected resources, if the impersonated client fails to, or is unable to, keep its client credentials confidential. For more details read
<a href=https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-31#section-10.2 rel=noopener>draft-ietf-oauth-v2-31</a>.</p><p>Example - Applications leaving context and opening new window to authenticate. Real examples include android web apps & some websites redirecting you to another website in new tab. The control moves from your application to another website in new tab, thus making it very risky.</p><p><img src=/garden/Excalidraw/oauth/implicit-grant-flow.excalidraw.png title=/garden/Excalidraw/oauth/implicit-grant-flow.excalidraw.png>
The lines illustrating steps A and B are broken into two parts as they pass through the user-agent.</p><h3 id=resource-owner-password-credentials-grant>Resource Owner Password Credentials Grant</h3><p>The resource owner password credentials grant type is suitable in cases where the resource owner has a trust relationship with the client, such as the device operating system or a highly privileged application.</p><p>This grant type is suitable for clients capable of obtaining the resource owner&rsquo;s credentials (username and password, typically using an interactive form). It is also used to migrate existing clients using direct authentication schemes such as HTTP Basic or Digest authentication to OAuth by converting the stored credentials to an access token.</p><p>Example - Standalone applications in your device like netflix app in andorid phone.</p><p><img src=/garden/Excalidraw/oauth/resource-owner-password-credentials-flow.excalidraw.png title=/garden/Excalidraw/oauth/resource-owner-password-credentials-flow.excalidraw.png></p><h3 id=client-credentials-grant>Client Credentials Grant</h3><p>The client can request an access token using only its client credentials (or other supported means of authentication) when the client is requesting access to the protected resources under its control, or those of another resource owner that have been previously arranged with the authorization server).</p><p>Example - Application Hosted in Cloud Foundry authenticating to get access to backing service.</p><p><img src=/garden/Excalidraw/oauth/client-credentials-flow.excalidraw.png title=/garden/Excalidraw/oauth/client-credentials-flow.excalidraw.png></p><h2 id=conclusion>Conclusion</h2><p>I didn&rsquo;t cover authorization request/response, access token request/response formats and security considerations here. Please refer RFC for getting detailed request/response formats. The OAuth 2.0 Core Framework (RFC 6749) only defines roles and a base level of functionality. Implementation details are left unspecified as out of scope for RFC. OAuth Working Group has published additional RFCs built on top of core framework to fill missing gaps. I would try covering some of those RFCs in future notes.</p><p>This note only covers essential content from
<a href=https://www.rfc-editor.org/rfc/rfc6749.html rel=noopener>RFC 6749: The OAuth 2.0 Authorization Framework</a>.</p></article><hr><div class=page-end><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/garden/>Shubham's Digital GardenðŸª´</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://prophet1906.github.io/garden/js/graph.27e8521c25c27c79dea35f434c486167.js></script>
<script>drawGraph("https://prophet1906.github.io/garden/notes/oauth2","https://prophet1906.github.io/garden",[{"/books":"#ca1919"}],-1,!0,!0,!0)</script></div></div><div id=contact_buttons><footer><p>Made by Shubham using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2022</p><ul><li><a href=/>Home</a></li><li><a href=https://twitter.com/Shubham_null>Twitter</a></li><li><a href=https://github.com/prophet1906>Github</a></li></ul></footer></div><script src=https://prophet1906.github.io/garden/js/popover.e57188d2e4c06b0654e020b3a734bb62.min.js></script>
<script>initPopover("https://prophet1906.github.io/garden")</script></div></body></html>